<head>

	<title>GoBBit - Reddit's like Forum software written in Golang</title>

	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

	<!-- CSS -->
	<link rel="stylesheet" href="/css/vendor/kube.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="/css/gobbit.css">

	<!-- JS Libs -->
	<script src="/js/vendor/jquery.js"></script>
	<script src="/js/vendor/kube.min.js"></script>
	<script src="/js/vendor/moment.js"></script>
	<script src="/js/vendor/angular.min.js"></script>

</head>

<body ng-app="GoBBit">

	<div ng-controller="App" ng-init="user={};topics=[];communities=[];community=null;">

		<div id="navbar" class="sticky">
			<nav id="navbar-main" class="row">
				<ul class="col col-10" style="display: block;list-style-type: none;">
					<li><a ng-click="getHomeTopics(0)" href="#!">{{ translation.home }}</a></li>
					<li><a href="#!">{{ translation.recent }}</a></li>
				</ul>

				<ul class="col col-2" style="display: block;list-style-type: none;">
					<!-- Log out and user info -->
					<li ng-if="user.username"><a href="#!">{{ user.username }}</a></li>
					<li ng-if="user.username"><a href="/logout">{{ translation.logout }}</a></li>
				</ul>
			</nav>
		</div>

		<center>
			<div style="width:80%;">
				<h3>Welcome to GoBBit</h3>
				<i>Reddit's like Forum software written in Golang</i>

				<!-- Login / registration form -->
				<div class="row around" ng-if="!user.username" style="padding:10px">
					<div ng-controller="login" class="col col-6">
						<div class="form-item">
							<label>Username</label>
							<input type="text" name="username" ng-model="username" class="width-50">
						</div>
						<div class="form-item">
							<label>Password</label>
							<input type="password" name="password" ng-model="password" class="width-50">
						</div>

						<br>
						<button ng-click="login()" class="button primary width-35">{{ translation.login }}</button>
					</div>

					<div ng-controller="register" class="col col-6">
						<div class="form-item">
							<label>Username</label>
							<input type="text" name="username" ng-model="username" class="width-50">
						</div>
						<div class="form-item">
							<label>Email</label>
							<input type="email" name="email" ng-model="email" class="width-50">
						</div>
						<div class="form-item">
							<label>Password</label>
							<input type="password" name="password" ng-model="password" class="width-50">
						</div>
						<div class="form-item">
							<label>Repeat Password</label>
							<input type="password" name="rpassword" ng-model="rpassword" class="width-50">
						</div>

						<br>
						<button ng-click="register()" class="button primary width-35">{{ translation.register }}</button>
					</div>
				</div>

			</div>
		</center>

		<!-- Communities Dropdown -->
		<div style="left: 10%;position: relative;margin:5px">
			<button data-component="dropdown" data-target="#communities-dropdown">Communities<span class="caret down"></span></button>
		</div>
		<div class="dropdown" id="communities-dropdown">
			<center>
				
				<ul class="communities">
					<li ng-click="setCommunity($index)" style="float:none;" ng-repeat="c in communities"><a class="community" href="#!">{{ c.name }}</a></li>
				</ul>

				<a href="#!" data-action="dropdown-close">Close</a>
			</center>
		</div>

		<!-- Commnity info (if selected) -->
		<center ng-if="community" class="width-80 bgimage" style="background-image:url({{ community.picture }});">
			<div class="blurcontent">
				<h2 style="color:white">{{ community.name }}</h2>
				<i>{{ community.description }}</i>
				<br>
				<i><b>{{ translation.created }}</b>: {{ formatDateComplete(community.creation_date) }}</i>

				<div class="row centered">
					<div class="col-1">
						<i class="fa fa-pencil" aria-hidden="true"></i>
						{{ community.posts_number }}
					</div>
					<div class="col-1">
						<i class="fa fa-comments" aria-hidden="true"></i>
						{{ community.topics_number }}
					</div>
					<div class="col-1">
						<i class="fa fa-user-md" aria-hidden="true"></i>
						{{ community.mods.length }}
					</div>
				</div>

				<div class="follow_community_btn">
					<button ng-if="user.followed_communities.indexOf(community.slug) < 0" class="button inverted outline" ng-click="followCommunity(community.slug)">
						{{ translation.follow }}
					</button>
					<button ng-if="user.followed_communities.indexOf(community.slug) >= 0" class="button red outline" ng-click="unfollowCommunity(community.slug)">
						{{ translation.unfollow }}
					</button>
				</div>

			</div>
		</center>

		<!-- Topics table -->
		<center>
			<table class="striped" style="width:80%">
				<thead>
			        <tr>
			            <th class="width-50">{{ translation.title }}</th>
			            <th class="width-30">{{ translation.community }}</th>
			            <th class="width-20">{{ translation.last_update }}</th>
			        </tr>
			    </thead>
			    <tbody>
			        <tr ng-repeat="t in topics">
			            <td class="width-50">
			            	<b><a href="#!">{{ t.title }}</a></b>
			            	<br>
			            	<a href="#!" style="color:black;font-size:12px">{{ t.user.username }}</a>
			            </td>
			            <td class="width-30">
			            	<a href="#!" ng-click="setCommunityBySlug(t.community)">
			            		{{ t.community }}
			            	</a>
			            </td>
			            <td class="width-20">{{ formatDate(t.last_update) }}</td>
			        </tr>
			    </tbody>
			</table>
		</center>

	</div>

	<script type="text/javascript">
		var myApp = angular.module('GoBBit',[]);
	</script>

	<!-- Angular Controllers -->
	<script type="text/javascript" src="/js/appcontroller.js"></script>
	<script type="text/javascript" src="/js/logincontroller.js"></script>
	<script type="text/javascript" src="/js/registercontroller.js"></script>

</body>